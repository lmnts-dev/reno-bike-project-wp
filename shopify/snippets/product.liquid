{% comment %}

Product:
The product page component.

@author Peter Laxalt
@since 3/2020
@stylesheet product.scss

{% endcomment %}

{% comment %}
@todo: Hook into Product Data
{% endcomment %}

{% comment %}
  Get first variant, or deep linked one
{% endcomment %}
{% assign current_variant = product.selected_or_first_available_variant %}

{% comment %}
Begin product page component
{% endcomment %}

<section class="product padding-top-none" itemscope itemtype="http://schema.org/Product">
  <div class="product-inner">
    <div class="col image-col">
      {% if product.images.size > 1 %}
        <div class="featured-images">
          {% for image in product.images %}
            <div class="img-wrapper">
              <img itemprop="image" data-src="{{ image | img_url: 'large' }}" alt="{{ image.alt | escape }}" class="lazy" />
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <div class="specifics-outer">
        {% include 'accordion-row' id:1, headline: 'Details', content: accordionContent %}
        {% include 'accordion-row' id:2, headline: 'Pick Up Instructions', content: accordionContent %}
        {% include 'accordion-row' id:3, headline: 'Shipping', content: accordionContent %}
      </div>
    </div>

    <div class="col details">
      <div class="details-top">

        {% comment %}
          ID addToCartForm is a selector for the ajax cart plugin
        {% endcomment %}
        <form action="/cart/add" method="post" enctype="multipart/form-data" id="AddToCartForm" class="form-vertical">

          <div class="title-and-price">
            <div class="title">
              <h1 itemprop="name">
                {{ product.title }} 
              </h1>
            </div>
            <div class="price">
              {% comment %}<span class="visually-hidden">{{ 'products.general.regular_price' | t }}</span>{% endcomment %}
              <span itemprop="priceCurrency" content="USD">$</span>
              <span itemprop="price" content="1000.00" id="ProductPrice" content="{{ current_variant.price | divided_by: 100.00 }}">
                {{ current_variant.price | money | remove: '$' }}
              </span>

              {% if product.compare_at_price_max > product.price %}
                {% comment %}<span class="visually-hidden">{{ 'products.general.sale_price' | t }}</span>{% endcomment %}
                <span class="compare-price" id="ComparePrice">
                  <strike>
                    {{ current_variant.compare_at_price | money }}
                  </strike>
                </span>
              {% endif %}

            </div>
            </span>
          </div>

          <div class="quantity-and-purchase">
            {% if product.available %}
              <div class="quantity">
                <input type="number" id="Quantity" name="quantity" value="1" min="1" class="quantity-selector">
              </div>
            {% endif %}
            <div class="purchase">
              {% if product.available %}
                <button type="submit" name="add" id="AddToCart" class="btn btn-clr-black btn-arrow">Add to basket</button>
              {% else %}
                <button class="btn btn-clr-black sold-out-btn">Sold Out</button>
              {% endif %}
            </div>
          </div>

          {% assign variantSize = product.variants | size %}
          {% if variantSize > 1 and product.available %}
            <div class="variant-selector">
              <select name="id" id="productSelect" class="selecter">
            
                {% for variant in product.variants %}
                  {% if variant.available %}
                    <option {% if variant == product.selected_or_first_available_variant %} selected="selected" {% endif %} data-sku="{{ variant.sku }}" value="{{ variant.id }}">{{ variant.title }} - {{ variant.price | money }}</option>
                  {% else %}
                    <option disabled="disabled">
                      {{ variant.title }} - Sold Out
                    </option>
                  {% endif %}
                {% endfor %}
              </select>
            </div>
          {% endif %}
        </form>
      {% comment %}
        End form
      {% endcomment %}

      <div class="description" itemprop="description">
        <p>
          {{ product.description }}
        </p>
      </div>

    </div>

    <div class="specifics-outer mobile-visible">
      {% if product.metafields.details %}
        {% include 'accordion-row' id:1, headline: 'Details', content: product.metafields.details  %}
      {% endif %}
      {% include 'accordion-row' id:2, headline: 'Pick Up Instructions', content: accordionContent %}
      {% include 'accordion-row' id:3, headline: 'Shipping', content: accordionContent %}
    </div>

    <div class="details-bottom">
      <span>
        Keep Browsing
      </span>
      <ul>
        {% for link in linklists.main-navigation.links | limit: 4 %}
          <li>
            {{ link.title | link_to: link.url }}
          </li>
        {% endfor %}
        <li>
          <a href="/collections/">
            All Products
          </a>
        </li>
      </ul>
    </div>
  </div>

</section>


<!-- 
{% assign current_variant = product.selected_or_first_available_variant %}
{% assign featured_image = current_variant.featured_image | default: product.featured_image %}
<img src="{{ featured_image | img_url: 'large' }}" alt="{{ featured_image.alt | escape }}" id="ProductPhotoImg">
{% for image in product.images %}
  <a href="{{ image.src | img_url: 'large' }}">
    <img src="{{ image.src | img_url: 'compact' }}" alt="{{ image.alt | escape }}">
  </a>
{% endfor %}
<h1>{{ product.title }}</h1>
<form action="/cart/add" method="post" enctype="multipart/form-data" id="AddToCartForm">
  <select name="id" id="productSelect">
    {% for variant in product.variants %}
      {% if variant.available %}
        <option value="{{ variant.id }}">
          {{ variant.title }} - {{ variant.price | money_with_currency }}
        </option>
      {% else %}
        <option disabled="disabled">
          {{ variant.title }} - sold out
        </option>
      {% endif %}
    {% endfor %}
  </select>
  {{ current_variant.price | money }}
  <label for="Quantity">quantity</label>
  <input type="number" id="Quantity" name="quantity" value="1" min="1">
  <button type="submit" name="add" id="AddToCart">Add to cart</button>
</form>
<div>{{ product.description }}</div> -->